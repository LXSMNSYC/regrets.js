var Regrets=function(t){"use strict";const e=Promise.resolve.bind(Promise),n=Promise.all.bind(Promise);class s{constructor(t){this.promise=e(t)}then(t){return"function"==typeof t?new s(this.promise.then(n=>n?e(t()).then(()=>n):this.promise)):this}else(t){return"function"==typeof t?new s(this.promise.then(n=>n?this.promise:e(t()).then(()=>n))):this}elseIf(t){return new s(this.promise.then(e=>!e&&t))}}class r{constructor(t){this.subject=t,this.cases=[]}case(...t){return this.cases=[...this.cases,...t],this}setParent(t){return this.parent=t,this}parentBroken(){return this.parent instanceof r&&(this.parent.breakSuccess||this.parent.parentBroken())}notBroken(){return!this.breakSuccess&&!this.parentBroken()&&(this.broken&&(this.breakSuccess=!0),!0)}do(t){const{subject:s}=this,i="function"==typeof s,o="function"==typeof t;return new r(n(this.cases).then(n=>e(i?s():s).then(s=>n.includes(s)?e(o?this.notBroken()&&e(t()).then(()=>s):t):s))).setParent(this)}break(){return this.parent instanceof r&&(this.parent.broken=!0),this}default(t){const{subject:n}=this,s="function"==typeof t;return e("function"==typeof n?n():n).then(()=>s?!this.parentBroken()&&t():t)}}const i=(t,n,s)=>e(s?t():t).then(r=>!!r&&e(n()).then(()=>i(t,n,s)));const o=(t,n,s)=>e(n()).then(()=>e(s?t():t).then(e=>!e&&o(t,n,s)));return t.If=s,t.Switch=r,t.While=class{constructor(t){this.evaluator=t}do(t){return i(this.evaluator,t,"function"==typeof this.evaluator)}},t.Repeat=class{constructor(t){this.scope=t}until(t){return o(t,this.scope,"function"==typeof t)}},t.not=(t=>e(t).then(t=>!t)),t.and=((t,e)=>n([t,e]).then(t=>t[0]&&t[1])),t.or=((t,e)=>n([t,e]).then(t=>t[0]||t[1])),t.eq=((t,e)=>n([t,e]).then(t=>t[0]===t[1])),t.ne=((t,e)=>n([t,e]).then(t=>t[0]!==t[1])),t.gt=((t,e)=>n([t,e]).then(t=>t[0]>t[1])),t.ge=((t,e)=>n([t,e]).then(t=>t[0]>=t[1])),t.le=((t,e)=>n([t,e]).then(t=>t[0]<=t[1])),t.lt=((t,e)=>n([t,e]).then(t=>t[0]<t[1])),t}({});